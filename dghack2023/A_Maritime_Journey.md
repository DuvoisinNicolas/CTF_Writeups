# PART 1

```
Pour commencer votre investigation, vous devez retrouver le standard utilisé par les systèmes de navigation dont voici l'une des trames :
$GPRMC,.00,A,4821.984,N,00429.118,W,17.0,170.4,2023,,,A,S*09
Format du Flag : DGHACK{nom_du_standard_numéro} (tout attaché, sans underscore)
```

Just by googling GPRMC part, we easily see that the standard is NMEA 0183. The flag is DGHACK{NMEA0183}

# PART 2

```
Lors de vos analyses, vous avez besoin de retrouver l'une des routes maritime empruntée par le Sam Brandy.
Retrouver les coordonnées GPS à partir de la trame suivante :
$GPGGA,123519,4815.970,N,0447.340,W,1,08,0.9,545.4,M,46.9,M, ,*41
Donnez le résultat au format "degré" "minute" "seconde" (arrondi au centième de seconde).
Format du Flag : DGHACK{DDMMSS.SS[N|S],DDMMSS.SS[W|E]}
```

We get 48.26616667 -44.12233333 as cordinates when decoding using https://swairlearn.bluecover.pt/nmea_analyser.

And using https://www.gps-coordinates.net we get:

Lat = N 48° 15' 58.2''

Long = W 04° 47' 20.399''

so flag is DGHACK{481558.20N,044720.40W}

# PART 3

Forgot to write that part.. Trivial anyway, right ? :)

# PART 4

```
Il semble que le Sam Brandy ait été identifié le 14/09/2023 loin de sa zone d'opération. Bien que cela vous semble troublant, vous décidez de reconstituer les évènements grâces aux trames que vous avez récupérés :
$GPGSV,3,1,9,27,65,309,24,31,63,061,10,16,57,203,34,26,55,143,171E $GPGSV,3,2,9,05,36,257,29,28,32,048,29,08,27,312,34,18,27,109,1940
$GPGSV,3,3,9,09,17,232,2876
Les coordonnées indiquées sont les suivantes :
30°41'24.0''S 133°42'0.0''W
Vous devez retrouver à qu'elle heure il a été aperçu (GMT+00) ?
Format du Flag : DGHACK{OCEAN_HH_MM}
Fichier join : https://www.dghack.fr/uploads/event-dghack-2023/a-maritime-journey/diagram.png
```
We are given a set of GSV data.

Once analysed, we extract these important data:
```
USA-242 : 65,309
USA-190 : 63,061
USA-166 : 57,203
USA-260 : 55,143
USA-206 : 36,257
USA-343 : 32,048
USA-262 : 27,312
USA-293 : 27,109
USA-256 : 17,232
```
There are the satelite name which i got from the SV PRN number, the altitude, and the azimuth that has been registered.

We know the day is 14th september 2023.

I used this map:
https://in-the-sky.org/satmap_worldmap.php?year=2023&month=09&day=16

I've set my cordinates to 30°41'24.0''S 133°42'0.0''W, which are equal to Lat: -30.69 Long :-133.7.

Using the satelite research function, i found the USA 242.

Once i've done it, i changed hours, until i saw the values matching with the USA 242 ones, which means 65 latitude and 309 Azimuth.

That matched with the hour 20h53. Since the website is in GMT +1, i removed 1 hour, which gave me the exact hour: 19h53.

Also, the cordinates are in the Pacific Ocean.

That gives us the flag DGHACK{PACIFIC_19_53} !

# PART 5

I gathered the cordinates i gathered with $XXRMC packets, then i used this script:

```python
import matplotlib.pyplot as plt
import numpy as np

x = [5000.590,5000.595,5000.600,5000.605,5000.611,5000.617,5000.623,5000.628,5000.634,5000.639,5000.645,5000.651,5000.657,5000.662,5000.667,5000.673,5000.678,5000.683,5000.688,5000.693,5000.697,5000.699,5000.699,5000.699,5000.699,5000.715,5000.719,5000.722,5000.724,5000.726,5000.728,5000.729,5000.730,5000.729,5000.729,5000.572,5000.576,5000.580,5000.585,5000.590,5000.595,5000.600,5000.605,5000.611,5000.617,5000.623,5000.628,5000.634,5000.639,5000.645,5000.651,5000.657,5000.662,5000.667,5000.673,5000.678,5000.683,5000.688,5000.693,5000.697,5000.702,5000.705,5000.709,5000.712,5000.715,5000.719,5000.722,5000.724,5000.726,5000.728,5000.729,5000.730,5000.731,5000.731,5000.731,5000.731,5000.731,5000.731,5000.731,5000.732,5000.733,5000.735,5000.737,5000.739,5000.742,5000.745,5000.749,5000.754,5000.758,5000.763,5000.769,5000.775,5000.781,5000.787,5000.794,5000.800,5000.807,5000.814,5000.821,5000.827,5000.834,5000.841,5000.849,5000.856,5000.863,5000.870,5000.878,5000.885,5000.892,5000.899,5000.906,5000.914,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5000.910,5001.073,5001.072,5001.072,5001.073,5001.076,5001.078,5001.081,5001.084,5001.088,5001.094,5001.100,5001.109,5001.120,5001.132,5001.144,5001.157,5001.170,5001.182,5001.194,5001.205,5001.217,5001.228,5001.239,5001.249,5001.259,5001.269,5001.279,5001.289,5001.298,5001.306,5001.314,5001.322,5001.330,5001.339,5001.347,5001.355,5001.363,5001.372,5001.384,5001.396,5001.409,5001.421,5001.432,5001.444,5001.455,5001.466,5001.477,5001.486,5001.491,5001.493,5001.493,5001.494,5001.495,5001.497,5001.498,5001.499,5001.501,5001.503,5001.504,5001.506,5001.507,5001.508,5001.509,5001.509,5001.509,5001.508,5001.507,5001.506,5001.505,5001.504,5001.503,5001.504,5001.506,5001.508,5001.510,5001.512,5001.514,5001.517,5001.520,5001.523,5001.527,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.530,5001.994,5002.001,5002.007,5002.014,5002.020,5002.027,5002.033,5002.040,5002.047,5002.053,5002.059,5002.066,5002.073,5002.080,5002.086,5002.093,5002.100,5002.107,5002.113,5002.120,5002.127,5002.133,5002.141,5002.148,5002.154,5002.160,5002.167,5002.174,5002.181,5002.187,5002.194,5002.200,5002.207,5002.214,5002.221,5002.227,5002.234,5002.240,5002.247,5002.254,5002.260,5002.267,5002.273,5002.280,5002.286,5002.293,5002.299,5002.306,5002.312,5002.319,5002.325,5002.332,5002.338,5002.344,5002.350,5002.357,5002.363,5002.369,5002.376,5002.382,5002.389,5002.395,5002.401,5002.407,5002.414,5002.420,5002.426,5002.432,5002.438,5002.444,5002.451,5002.457,5002.463,5002.469,5002.475,5002.482,5002.488,5002.494,5002.500,5002.506,5002.512,5002.519,5002.525,5002.531,5002.537,5002.543,5002.550,5002.556,5002.562,5002.568,5002.574,5002.580,5002.586,5002.592,5002.598,5002.604,5002.610,5002.616,5002.623,5002.628,5002.634,5002.640,5002.647,5002.653,5002.658,5002.664,5002.671,5002.677,5002.683,5002.688,5002.694,5002.700,5002.707,5002.713,5002.719,5002.725]
y = [958.121,958.123,958.126,958.128,958.131,958.134,958.137,958.141,958.146,958.151,958.156,958.161,958.167,958.174,958.181,958.187,958.195,958.203,958.211,958.220,958.229,958.234,958.234,958.234,958.234,958.278,958.288,958.298,958.309,958.320,958.331,958.342,958.353,958.348,958.348,958.115,958.116,958.118,958.120,958.121,958.123,958.126,958.128,958.131,958.134,958.137,958.141,958.146,958.151,958.156,958.161,958.167,958.174,958.181,958.187,958.195,958.203,958.211,958.220,958.229,958.238,958.247,958.257,958.267,958.278,958.288,958.298,958.309,958.320,958.331,958.342,958.353,958.364,958.376,958.387,958.399,958.410,958.421,958.433,958.444,958.455,958.466,958.477,958.488,958.498,958.509,958.519,958.528,958.537,958.545,958.553,958.560,958.566,958.572,958.578,958.583,958.588,958.592,958.596,958.600,958.603,958.606,958.608,958.610,958.612,958.613,958.613,958.613,958.613,958.612,958.610,958.608,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.609,958.327,958.309,958.290,958.271,958.252,958.233,958.213,958.194,958.176,958.158,958.141,958.127,958.116,958.108,958.103,958.100,958.100,958.103,958.109,958.117,958.126,958.136,958.146,958.157,958.169,958.181,958.193,958.205,958.219,958.235,958.251,958.267,958.282,958.297,958.313,958.328,958.344,958.357,958.366,958.370,958.367,958.360,958.351,958.341,958.333,958.324,958.314,958.299,958.280,958.260,958.240,958.221,958.201,958.182,958.162,958.142,958.123,958.103,958.083,958.063,958.043,958.023,958.004,957.984,957.964,957.945,957.925,957.905,957.885,957.865,957.845,957.826,957.806,957.787,957.767,957.748,957.729,957.709,957.690,957.671,957.652,957.634,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,957.642,956.441,956.424,956.407,956.389,956.372,956.355,956.338,956.321,956.304,956.287,956.270,956.253,956.236,956.220,956.203,956.186,956.169,956.153,956.137,956.120,956.103,956.086,956.069,956.052,956.036,956.019,956.003,955.986,955.969,955.952,955.935,955.918,955.901,955.885,955.868,955.851,955.834,955.817,955.800,955.784,955.766,955.750,955.733,955.717,955.700,955.683,955.666,955.649,955.632,955.614,955.597,955.580,955.562,955.545,955.529,955.512,955.495,955.477,955.460,955.443,955.426,955.408,955.391,955.374,955.357,955.340,955.323,955.306,955.289,955.272,955.254,955.237,955.219,955.202,955.185,955.168,955.150,955.133,955.116,955.098,955.081,955.064,955.047,955.029,955.012,954.995,954.978,954.960,954.943,954.925,954.907,954.890,954.873,954.855,954.838,954.820,954.803,954.786,954.768,954.750,954.732,954.715,954.698,954.680,954.663,954.645,954.628,954.610,954.593,954.576,954.559,954.541,954.524,954.506,954.489,954.471]

plt.scatter(x, y)
plt.show()
```
It showed me the boat path. We can see that it was stuck on the y axis at the value 958.609 for quite a while.

I searched packets that contained 958.609:

This one was the last one before being stuck :
```
$GPGGA,170334.50,5000.910034,N,958.609,W,0,00,,,M,0.0,M,,*79
```

And this one was the first stuck packet:
```
$GPRMC,170335.10,V,5000.910034,N,958.609,W,,,2023,09,12,A,N*03
```


Using their UTC times, i figured out the flag (one of these,i can't remember):

`DGHACK{12092023170333}` or `DGHACK{12092023170334}` or `DGHACK{12092023170335}` (kinda brute forced this one eheh)

# PART 6

```
Après avoir compris que le Sam Brandy s'est peut-être retrouvé dans une zone exposée au risque de brouillage GPS, il est probable que, d'après votre expérience, l'un des navires rencontrés par le Sam Brady ait cherché à cacher ses activités illicites (pêches illégales, contrebande, piraterie, ...). Vous avez récupéré les enregistrements AIS captés par le remorqueur, essayez d'identifier un navire qui aurait changer d'identité maritime en cours de route.
Format du Flag : DGHACK{oldDATA_newDATA}
Fichier join : https://www.dghack.fr/uploads/event-dghack-2023/a-maritime-journey/AIS_dump.txt
```

Gosh, this one seems to be pure hell :)
After reading some docs about AIS, i saw that packet has different types.
The one that uses 5 contains the maritime identifier, called "mmsi".

I used pyais that allows to parse and decode AIS datas.
Inside it, i looked for boats that had the same name and callsigns, but different mmsi.

I used this script:
```
from pyais.stream import FileReaderStream

filename = "AIS_dump.txt"
mmsis = []
shipname_with_mmsi = []
i = 0
for msg in FileReaderStream(filename):
	decoded = msg.decode().asdict()
	if 'shipname' in decoded and 'callsign' in decoded  and decoded['callsign'] != '' and (decoded['mmsi'], decoded['shipname'], decoded['callsign']) not in shipname_with_mmsi :
		mmsis.append(decoded['mmsi'])
		shipname_with_mmsi.append((decoded['mmsi'], decoded['shipname'], decoded['callsign']))
	
	# Progress
	i+=1
	if (i%100000 == 0):
		print(i)
	
for elem in shipname_with_mmsi:
	for elem2 in shipname_with_mmsi:
		if elem[1] == elem2[1] and elem[2] == elem2[2] and elem[0] != elem2[0] :
			print(elem)
			print(elem2)

```
Which gave me these result:
```
(227861937, 'DELTA YELLOW', 'DY34975')
(883686372, 'DELTA YELLOW', 'DY34975')
(368227640, 'HARMONY', 'HARMONY')
(338417401, 'HARMONY', 'HARMONY')
(338417401, 'HARMONY', 'HARMONY')
(368227640, 'HARMONY', 'HARMONY')
(883686372, 'DELTA YELLOW', 'DY34975')
(227861937, 'DELTA YELLOW', 'DY34975')
```

I tried the first possibility for the flag: `DGHACK{227861937_883686372}`.
And.. that was the correct flag.

Really liked this challenge, unusual one :)




